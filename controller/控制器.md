# 控制器

## 定义
在 orange 框架中，控制器是这样一个函数 `func(ctx *app.Context) error`，如下是典型的控制器定义
```
import (
   "gitee.com/zhucheer/orange/app"
)

func Welcome(c *app.Context) error {

   return c.ToJson(map[string]interface{}{
      "info": "orange is a fast api framework",
   })
}

```

## 获取请求

### 获取参数
 在 orange 中通过参数绑定的方式获取参数，参数绑定方式能获取表单提交类型的参数和json类型的参数，兼容性好。

具体代码如下：

```
...
func Welcome(c *app.Context) error {
    req := struct {
       Id int `json:"id"`
    }{}
   err := c.ParseForm(&req)
   if err != nil {
      return c.ResponseWrite([]byte("参数解析错误"))
   }

...
}
...
```
> 注意：请求参数中包含&、>、<等特殊符号时需要进行 urlencode 编码，通过参数绑定后会自动进行 urldecode 解码；
> 例如传递参数是一个 url 时，需要对该参数进行 urlencode 后传入。
 


### 请求响应
Orange 对原生http响应进行了封装，有如下方法处理http响应
- c.ResponseWrite([]byte) 输出原始响应内容
- c.ResponseHeader() 配置/获取响应头
- c.ToJson(interface{}) 以json的方式输出响应
- c.ToString(string) 以字符串的方式输出响应

代码参考
```
...
func Welcome(c *app.Context) error {
    return c.ResponseWrite([]byte("欢迎访问orange框架")) 
...
}

func WelcomeJson(c *app.Context) error {
    return c.ToJson(map[string]interface{}{
       "info": "orange is a fast api framework",
    })
}

func WelcomeText(c *app.Context) error {
    c.ResponseHeader().Set("Content-Type","application/text")
    return c.ToString( "orange is a fast api framework")
}

...
```



